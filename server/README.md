# 服务端配置管理

## 配置文件

项目使用 `.env` 和 `.env.local` 文件来管理配置：

- `.env`: 基础配置文件，包含默认配置
- `.env.local`: 本地覆盖配置文件，可以覆盖基础配置中的设置

## 配置加载顺序

1. 首先加载 `.env` 文件中的所有配置
2. 然后加载 `.env.local` 文件中的配置（如果存在），覆盖相同的配置项
3. 如果某个配置在两个文件中都不存在，则使用代码中定义的默认值


## 使用方法

1. 复制 `.env.example` 文件（如果存在）到 `.env` 文件，并设置基础配置
2. 创建 `.env.local` 文件来覆盖本地开发环境需要的配置
3. 确保 `.env.local` 文件已添加到 `.gitignore` 中，避免将本地配置提交到版本控制

> 注意：不要在 `.env` 文件中存储敏感信息（如生产环境密码和密钥），因为它会被提交到版本控制。敏感信息应该放在 `.env.local` 文件中或者使用环境变量注入。 


# JWT 配置


# JWT配置详细说明

## 1. JWT_SECRET_KEY（JWT密钥）

**作用**：这是用于签名和验证JWT令牌的密钥，是JWT安全机制的核心。
- 签名过程：系统使用此密钥对JWT令牌的头部和载荷部分进行加密签名
- 验证过程：系统使用同样的密钥验证令牌签名是否有效

**重要性**：
- 如果密钥泄露，攻击者可以伪造有效的JWT令牌，从而以任何用户身份访问系统
- 密钥强度直接关系到令牌的安全性

**最佳实践**：
- 在生产环境中使用长度至少32字符的随机字符串
- 定期更换密钥
- 永远不要硬编码在源代码中或提交到版本控制系统

## 2. JWT_TOKEN_EXPIRY（令牌过期时间）

**作用**：定义访问令牌的有效期限，单位为小时。
- 我们系统默认设置为24小时
- 过了这个时间，令牌将自动失效，用户需要重新登录

**重要性**：
- 过期机制限制了令牌被盗用的风险窗口期
- 即使令牌被盗，也只在有限时间内有效

**权衡考虑**：
- 时间太短：用户需要频繁登录，影响体验
- 时间太长：安全风险增加，被盗令牌的可用时间延长

## 3. JWT_REFRESH_EXPIRY（刷新令牌过期时间）

**作用**：定义刷新令牌的有效期限，单位为小时。
- 我们系统默认设置为168小时（7天）
- 刷新令牌用于在访问令牌过期后获取新的访问令牌，无需用户重新登录

**实现机制**：
- 当访问令牌过期时，前端可以使用刷新令牌请求新的访问令牌
- 这允许用户保持登录状态更长时间，同时限制单个访问令牌的有效期

**注意**：
- 当前我们系统只实现了访问令牌，没有实现刷新令牌机制
- 但配置已预留，可以在后续开发中实现完整的刷新机制

## 4. JWT_ISSUER（发行者）

**作用**：标识令牌的发行者，通常是应用程序或组织的名称。
- 在令牌的payload部分包含`iss`字段
- 系统验证令牌时会检查此字段，确保令牌来自预期的发行者

**应用场景**：
- 当存在多个系统或服务时，可以区分不同系统发放的令牌
- 有助于防止在多系统环境中令牌被跨系统使用

**安全价值**：
- 增加了一层验证，确保令牌是由可信来源颁发的
- 在微服务架构中特别有用，可以区分不同服务发放的令牌

 

